<!-- This file controls the view for user's profile pages.
It can be found at app/views/users/show.html.erb -->

<!-- This file's corresponding .scss file can be found at app/assets/stylesheets/users.scss -->
<%= javascript 'application' %>
<html>
<body style = "background-color: white; padding-top: 0px;">

<!-- This will display the name of the current user. -->
<h1><%= current_user.user_name%>'s Admin Page</h1>

<div class="container">
<span id="<%=current_user.id %>" class="adminId"></span>
  <div class="row" id="collapseExample">
    <div class="col-sm-3" id="adminButtons">

      <button id="groupBtn" type="button" class="btn btn-info">Add New Group</button>
        <!-- The Modal -->
        <div id="groupModal" class="modal">

          <!-- Modal content -->
          <div class="modal-content">
            <h4>Add New Group</h4>
              <button id="createGroup" type="button" class="btn btn-info">Create Group</button>

              <!-- Example here: https://datatables.net/examples/api/select_row.html -->
              <table id="allUsersGroups" class="table" style="width:100%">
                <thead>
                  <tr>
                    <th>Name</th>
                  </tr>
                </thead>
                <tbody>
                  <% @active_users.each do |usr| %>
                  <tr>
                    <td><%=usr[1]%></td>
                  </tr>
                  <% end %>
                </tbody>
                <tfoot>
                  <tr>
                    <th>Name</th>
                  </tr>
                </tfoot>
            </table>
          </div>
        </div>

      <button id="adminBtn" type="button" class="btn btn-info">Add Admin</button>
      <!-- The Modal -->
        <div id="adminModal" class="modal">

          <!-- Modal content -->
          <div class="modal-content">
            <h4>Add Admin</h4>
            <button id="createAdmin" type="button" class="btn btn-info">Make Admin</button>
            <table id="allUsersAdmin" class="table" style="width:100%">
                <thead>
                  <tr>
                    <th>Name</th>
                  </tr>
                </thead>
                <tbody>
                  <% @active_users.each do |usr| %>
                  <tr>
                    <td><%=usr[1]%></td>
                  </tr>
                  <% end %>
                </tbody>
                <tfoot>
                  <tr>
                    <th>Name</th>
                  </tr>
                </tfoot>
            </table>
          </div>
        </div>
        <style>

        </style>

        <script>
            $(
              $(document).ready(function() {
              // When the user clicks on the button, open the modal
              $("#groupBtn").click(function(){
               $("#groupModal").modal('show');
              })
              $("#adminBtn").click(function(){
               $("#adminModal").modal('show');
              })
              // When the user clicks anywhere outside of the modal, close it
              var modal = document.getElementsByClassName("modal")[0]
              window.onclick = function(event) {
                if (event.target == modal) {
                  modal.style.display = "none";
                }
              }
              $(document).ready(function() {
                  var table = $('#allUsersGroups').DataTable()

                  $('#allUsersAdmin tbody').on( 'click', 'tr', function () {
                        $(this).toggleClass('active');
                  } );
                  $('.createGroup').click( function () {
                      alert( table.rows('.active').data().length +' row(s) active' );
                  } );
                    //{
                    // select: {style: 'multi'},
                    //   buttons: [
                    //   {
                    //       text: 'Get selected data',
                    //       action: function () {
                    //           var count = table.rows( { selected: true } ).count()
                    //         }
                    //   }
                    // ]
                    // });
                  });
              $(document).ready(function() {
                  var table = $('#allUsersAdmin').DataTable();

                  $('#allUsersAdmin tbody').on( 'click', 'tr', function () {
                      $(this).toggleClass('active');
                  } );

                  $('.createAdmin').click( function () {
                      alert( table.rows('.active').data().length +' row(s) active' );
                  } );
              } );

              function showGroupInfo(groupNum) {
              // $.get('/scene_render/' + scenceId)//get HTML to insert
              //     .done(function(data)
              {
                // console.log(data);
                var group =$("#GroupWindow");
                group.html("");//clear previous data
              };
              }

              function bindGroupToggle()
              {
              // $("#groupToggle").click(function(){
              //   console.log("ho");
              //   document.cookie="group_number=" + this.id;
              //   console.log(document.cookie);
              //   });
              $(".groupToggle").click, function(index, element){
                console.log("Yeah");
                console.log(element);
                // element.click(function(){
                //   console.log("ho");
                //   document.cookie="group_number=" + element.id;
                //   console.log(document.cookie);
                };
              //});
              }
            })
            );
        </script>
    </div>

    <ul class="list-group">
      <h4>Groups</h4>
        <% groups = current_user.getGroups %>
        <% groups.uniq.each do |group| %>
           <a class="groupToggle" id=<%="group" + String(group[1])%> ><%=group[0]%></a>
        <% end %>
    </ul>

    <div class="col-sm-6" id="GroupWindow">
      <!-- this area displays the each group's info' -->
      <h4 style="margin-left: 10px" id="GroupName"> Group 1 :</h4>

    </div>

    <div class="group-info" id="groupInfo">

    </div>
</div>
</div>

</body>

</html>
